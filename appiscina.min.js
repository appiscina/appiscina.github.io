!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=4)}([function(e,t){e.exports=React},function(e,t){e.exports=MaterialUI},function(e,t){e.exports=AWS},function(e,t){e.exports=ReactDOM},function(e,t,o){"use strict";o.r(t);var n=o(0),a=o.n(n),r=o(3),i=o.n(r),s=o(1);const l=a.a.createElement,{Icon:c,IconButton:u,Snackbar:p}=s,d=a.a.createContext(),h=({children:e})=>{const[t,o]=a.a.useState([]),[n,r]=a.a.useState(void 0),[i,s]=a.a.useState(!1);a.a.useEffect(()=>{t.length&&!n?(r(t[0]),o(e=>e.slice(1)),s(!0)):t.length&&n&&i&&s(!1)},[t,n,i]);const h=a.a.useCallback(e=>{o(t=>[...t,e])},[]),g=(e,t)=>{"clickaway"!==t&&s(!1)};return l(d.Provider,{value:{showMessage:h}},e,l(p,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:i,autoHideDuration:5e3,onClose:g,onExited:()=>{r(void 0)},message:n,action:l(u,{color:"inherit",onClick:g},l(c,null,"close"))},null))};var g=d,m=o(2),f=o.n(m);const O=a.a.createElement,_=a.a.createContext(),C=({appConfig:e,children:t})=>O(_.Provider,{value:{appConfig:e}},t);var E=_;const v=a.a.createElement,S=a.a.createContext(),T=({children:e})=>{const{appConfig:{appAuthRedirect:t,appAuthUrl:o,appClientId:n,appIdentityPoolId:r,appRegion:i,appUserPoolId:s,appRefreshTokenStorageKey:l,appMessages:c}}=a.a.useContext(E),[u,p]=a.a.useState({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),[d,h]=a.a.useState(sessionStorage.getItem(l)),[g,m]=a.a.useState(void 0),[O]=a.a.useState(15e5),[_,C]=a.a.useState(void 0);a.a.useEffect(()=>{d?sessionStorage.setItem(l,d):sessionStorage.removeItem(l)},[d,l]);const T=a.a.useCallback(()=>new Promise(e=>{p({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),h(void 0),m(void 0),e()}),[]);a.a.useEffect(()=>{m(_?e=>e?(e.update({credentials:_}),e):new f.a.Config({region:i,credentials:_}):void 0)},[_,i]);const I=a.a.useCallback((e,t)=>{const o=new f.a.CognitoIdentityCredentials({IdentityPoolId:r,...e&&{Logins:{[s]:e}}},{region:i});return new Promise((n,a)=>{o.clearCachedId(),o.getPromise().then(()=>{C(o),p(n=>{const a=e&&JSON.parse(atob(e.split(".")[1]));return n.identityId=o.identityId,n.id=a&&a.sub,n.name=a?a.name:c.LOGGED_OUT_USER,n.email=a&&a.email,n.groups=a&&a["cognito:groups"],n.idToken=e,n.accessToken=t,n}),n()}).catch(e=>{C(void 0),p({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),a(e)})})},[r,i,s,c]),L=a.a.useCallback(e=>new Promise((t,a)=>{e?fetch(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=refresh_token&client_id=${n}&refresh_token=${e}`}).then(e=>{e.json().then(e=>{I(e.id_token,e.access_token).then(()=>{t()}).catch(e=>{console.error(c.LOG_COULD_NOT_LOGIN_WITH_REFRESHED_TOKENS,e),a(e)})}).catch(e=>{console.error(c.LOG_COULD_NOT_DECODE_AUTHENTICATION_RESPONSE,e),a(e)})}).catch(e=>{console.error(c.LOG_COULD_NOT_GET_REFRESHED_TOKENS,e),a(e)}):(console.warn(c.LOG_NO_REFRESH_TOKEN_AVAILABLE),a(new Error(c.LOG_NO_REFRESH_TOKEN_AVAILABLE)))}),[I,o,n,c]);((e,t)=>{const o=a.a.useRef(),n=a.a.useCallback(()=>{const e=o.current;e&&(o.current=void 0,clearInterval(e))},[o]);a.a.useEffect(()=>(o.current=setInterval(e,t),n),[e,t,n])})(a.a.useCallback(()=>{L(d).catch(e=>{console.error(c.LOG_COULD_NOT_REFRESH_TOKENS,e)})},[d,L,c]),O);const y=a.a.useCallback(()=>I(),[I]),w=a.a.useCallback(e=>new Promise((a,r)=>{fetch(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=authorization_code&client_id=${n}&code=${e}&redirect_uri=${t}`}).then(e=>{e.json().then(e=>{L(e.refresh_token).then(()=>{h(e.refresh_token),a()}).catch(e=>{console.error(c.LOG_COULD_NOT_LOGIN_WITH_REFRESHED_TOKENS,e),h(void 0),r(e)})}).catch(e=>{console.error(c.LOG_COULD_NOT_DECODE_AUTHENTICATION_RESPONSE,e),h(void 0),r(e)})}).catch(e=>{console.error(c.LOG_COULD_NOT_GET_IDENTIFICATION_TOKENS,e),h(void 0),r(e)})}),[L,t,o,n,c]);return a.a.useEffect(()=>{d&&!_&&L(d).catch(e=>{console.error(c.LOG_COULD_NOT_REFRESH_TOKENS,e)})},[d,_,L,c]),v(S.Provider,{value:{user:u,awsConfig:g,awsCredentials:_,loginAnonymously:y,loginWithAuthorizationCode:w,logoff:T}},e)};var I=S;const L=a.a.createElement,y=a.a.createContext(),w=({children:e})=>{const{awsConfig:t,awsCredentials:o}=a.a.useContext(I),[n,r]=a.a.useState();return a.a.useEffect(()=>{r(t?new f.a.DynamoDB.DocumentClient(t):void 0)},[t]),a.a.useEffect(()=>{o&&r(e=>(e&&e.service.config.update({credentials:o}),e))},[o]),L(y.Provider,{value:{documentDB:n}},e)};const N=a.a.createElement,D=a.a.createContext(),b=({children:e})=>{const{user:{accessToken:t},awsConfig:o,awsCredentials:n}=a.a.useContext(I),[r,i]=a.a.useState();a.a.useEffect(()=>{i(o?new f.a.Lambda(o):void 0)},[o]),a.a.useEffect(()=>{n&&i(e=>(e&&e.config.update({credentials:n}),e))},[n]);const s=a.a.useCallback((e,o)=>{const n={FunctionName:e,ClientContext:btoa(JSON.stringify({custom:{accessToken:t}}))};return o&&(n.Payload=JSON.stringify(o)),new Promise((e,t)=>{r.invoke(n).promise().then(o=>{o.StatusCode&&200===o.StatusCode&&o.Payload||t(o);const n=JSON.parse(o.Payload);n&&n.statusCode&&200===n.statusCode||t(o),e(n.body)}).catch(e=>{t(e)})})},[r,t]);return N(D.Provider,{value:{invokeLambda:r&&s}},e)};const R=a.a.createElement,{useParams:U,useHistory:k}=window.ReactRouterDOM,{Backdrop:P,CircularProgress:x}=s;var G=()=>{const{appConfig:{appMessages:e}}=a.a.useContext(E),{showMessage:t}=a.a.useContext(g),{loginWithAuthorizationCode:o}=a.a.useContext(I),{authorization_code:n}=U(),[r,i]=a.a.useState(!0),l=s.useTheme(),c=k();return a.a.useEffect(()=>{o(n).then(()=>{t(e.LOGIN_SUCCESSFUL),c.replace("/")}).catch(()=>{t(e.LOGIN_FAILED),i(!1)})},[n,o,t,c,e]),R(P,{open:r,style:{zIndex:1+l.zIndex.drawer}},R(x,null,null))};const A=a.a.createElement,{ThemeProvider:F}=s;var M=({children:e})=>{const[t]=a.a.useState(s.createMuiTheme({palette:{primary:{main:"#556cd6"}}}));return A(F,{theme:t},e)};const H=a.a.createElement;var B=({appConfig:e,children:t})=>H(M,null,H(h,null,H(C,{appConfig:e},H(T,null,H(w,null,H(b,null,t))))));const K=a.a.createElement,{useLocation:j}=window.ReactRouterDOM,{AppBar:z,Button:$,Divider:W,Icon:V,IconButton:J,Menu:q,MenuItem:Q,Toolbar:X,Typography:Y}=s,Z=()=>{const{appConfig:{appExternalLoginUrl:e,hideLogin:t}}=a.a.useContext(E),{user:{name:o}}=a.a.useContext(I);return o||t?null:K(a.a.Fragment,null,K($,{color:"inherit",href:e},"Login"))},ee=()=>{const{appConfig:{appMessages:e}}=a.a.useContext(E),{showMessage:t}=a.a.useContext(g),{user:{name:o},logoff:n}=a.a.useContext(I),[r,i]=a.a.useState(!1),s=a.a.useRef(null);return o?K(a.a.Fragment,null,K(J,{color:"inherit",ref:s,onClick:()=>{i(!0)}},K(V,null,"account_circle")),K(q,{open:r,onClose:()=>{i(!1)},anchorEl:s.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},K(Q,{disabled:!0},o),K(W,null,null),K(Q,{onClick:()=>{n().then(()=>{t(e.LOGOUT_SUCCESSFUL)}).catch(()=>{t(e.LOGOUT_FAILED)}),i(!1)}},"Logoff"))):null};var te=({setDrawerOpen:e,routes:t})=>{const o=j(),n=t.find(e=>e.path===o.pathname);return K(z,null,K(X,null,K(J,{edge:"start",color:"inherit",onClick:()=>e(!0)},K(V,null,"menu")),K(Y,{style:{flexGrow:1}},n?n.label:""),K(Z,null,null),K(ee,null,null)))};const oe=a.a.createElement,{NavLink:ne}=window.ReactRouterDOM,{Box:ae,Divider:re,Drawer:ie,Icon:se,ListItem:le,ListItemText:ce,Toolbar:ue}=s;var pe=({routes:e,drawerOpen:t,setDrawerOpen:o})=>{const{appConfig:{appLogoUrl:n}}=a.a.useContext(E),{user:{groups:r}}=a.a.useContext(I),i=()=>o(!1);return oe(ie,{open:t,onClose:i},oe(ue,{onClick:i,style:{padding:"inherit"}},oe(le,{button:!0,style:{justifyContent:"space-between",height:"100%"}},oe(ae,{style:{flex:"auto",textAlign:"center"}},oe("img",{src:n,width:"70px",height:"70px"},null)),oe(se,null,"chevron_left"))),oe(re,null,null),e.filter(e=>!e.hideFromMenu).filter(e=>{return!(t=e.authorizedGroups)||!!r&&t.some(e=>r.includes(e));var t}).map(e=>oe(le,{key:e.name+"-route-drawer-item",button:!0,component:ne,activeClassName:"Mui-selected",to:e.path,onClick:i,...e.options},oe(ce,{primary:e.label},null))))};const de=a.a.createElement,{HashRouter:he,Route:ge,Switch:me}=window.ReactRouterDOM,{Toolbar:fe}=s;var Oe=({appConfig:e,appRoutes:t})=>{const[o,n]=a.a.useState(!1),[r]=a.a.useState([...t,{name:"authentication",label:"Athentication",path:"/authentication/:authorization_code",hideFromMenu:!0,component:G}]);return a.a.useLayoutEffect(()=>{if(window.location.pathname===e.appBasePath){const t=new URLSearchParams(window.location.search);null!==t.get("auth-redirect")&&null!==t.get("code")&&window.history.replaceState({},"",`${e.appBasePath}#/authentication/${t.get("code")}`)}},[e.appBasePath]),de(B,{appConfig:e},de(he,null,de(te,{setDrawerOpen:n,routes:r},null),de(pe,{routes:r,drawerOpen:o,setDrawerOpen:n}),de(fe,null,null),de(me,null,r.map(e=>de(ge,{key:e.name+"-route",path:e.path,...e.options},de(e.component))))))};const _e=a.a.createElement,{Button:Ce,Container:Ee,Dialog:ve,DialogActions:Se,DialogContent:Te,DialogContentText:Ie,DialogTitle:Le,Grid:ye,Typography:we}=s,Ne=(({appHost:e,appBasePath:t,appRegion:o,appUserPoolId:n,appUserPoolDomain:a,appClientId:r,appIdentityPoolId:i,appRefreshTokenStorageKey:s,appLogoUrl:l,appMessages:c,hideLogin:u})=>{const p=`https://${a}.auth.${o}.amazoncognito.com`,d=`${e}${t}?auth-redirect`;return{appHost:e,appBasePath:t,appRegion:o,appUserPoolId:n,appUserPoolDomain:a,appClientId:r,appIdentityPoolId:i,appBaseAuthUrl:p,appAuthRedirect:d,appAuthUrl:p+"/oauth2/token",appExternalLoginUrl:`${p}/login?client_id=${r}&response_type=code&scope=email+openid+profile&redirect_uri=${d}`,appRefreshTokenStorageKey:s,appLogoUrl:l,appMessages:c,hideLogin:u||!1}})({appHost:"https://appiscina.github.io",appBasePath:"/",appLogoUrl:"/appiscina-logo.png",appRegion:"us-east-1",appUserPoolId:"cognito-idp.us-east-1.amazonaws.com/us-east-1_tbDFa4VWy",appUserPoolDomain:"appiscina",appClientId:"497hnirgfnmpglhu5cnbeb9c0d",appIdentityPoolId:"us-east-1:251730d0-7027-496e-b70f-20c19a053f62",appRefreshTokenStorageKey:"appiscina-refresh-token",appMessages:{LOGIN_SUCCESSFUL:"Usuário logado com sucesso",LOGIN_FAILED:"Não foi possível completar o login",LOGOUT_SUCCESSFUL:"Usuário deslogado com sucesso",LOGOUT_FAILED:"Não foi possível deslogar o usuário",LOGGED_OUT_USER:"Usuário não logado",LOG_COULD_NOT_LOGIN_WITH_REFRESHED_TOKENS:"Could not login with refreshed tokens",LOG_COULD_NOT_DECODE_AUTHENTICATION_RESPONSE:"Could not decode authentication response",LOG_COULD_NOT_GET_REFRESHED_TOKENS:"Could not get refreshed tokens",LOG_NO_REFRESH_TOKEN_AVAILABLE:"No refresh token available",LOG_COULD_NOT_REFRESH_TOKENS:"Could not refresh tokens",LOG_COULD_NOT_GET_IDENTIFICATION_TOKENS:"Could not get identification tokens with this authorization code"},hideLogin:!0}),De=[{name:"home",label:"Home",path:"/",hideFromMenu:!1,component:()=>{const[e,t]=Object(n.useState)(!1);return _e(Ee,null,_e(ye,{container:!0,justify:"center",spacing:2,alignItems:"center"},_e(ye,{item:!0},_e("img",{src:Ne.appLogoUrl},null)),_e(ye,{item:!0,xs:12,sm:8},_e(ye,{container:!0,justify:"",spacing:2},_e(ye,{item:!0,xs:12},_e(we,{variant:"h6"},"APPiscina")),_e(ye,{item:!0,xs:12},_e(we,{variant:"subtitle1"},"Aplicativo de economia colaborativa de compartilhamento de piscinas privadas")),_e(ye,{item:!0,xs:12},_e(ye,{container:!0,spacing:1,alignItems:"center"},_e(ye,{item:!0},_e(Ce,{variant:"contained",color:"primary",onClick:()=>t(!0)},"Ingressar na lista VIP")),_e(ye,{item:!0},_e(we,{variant:"body2"},"Seja um dos primeiros e torne-se um Piscineiro Fundador!"))))))),e?_e(ve,{open:!0},_e(Le,{},"Em breve!"),_e(Te,{},_e(Ie,{},"Ingresse na Lista VIP e indique seus amigos para obter o status de Piscineiro Fundador com benefícios vitalícios")),_e(Se,{},_e(Ce,{variant:"contained",color:"primary",onClick:()=>t(!1)},"Aguardar um pouco mais"))):null)},options:{exact:!0}}];i.a.render(_e(()=>_e(Oe,{appRoutes:De,appConfig:Ne}),null,null),document.getElementById("app_container"))}]);